<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>happy birthday p'ying</title>
    <link rel="shortcut icon" href="#">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="text-center">
<nav class="navbar">
    <a href="index.html"> </a>
  </nav>
<h1>happy birthday babe</h1>
<h3>don’t forget to make a wish <br> before blowing out the candle</h3>
<br>
<!-- <button id="start">START (required on Chrome)</button> -->
<button style="display: none" id="startconsoledebug">enable console logs</button>
<button style="display: none" id="stopconsoledebug">disable console logs</button>
<br>
<br>
<div id="cake-holder" style="opacity: 1">
	<div class="cake">
		<div class="plate"></div>
		<div class="layer layer-bottom"></div>
		<div class="layer layer-middle"></div>
		<div class="layer layer-top"></div>
		<div class="icing"></div>
		<div class="drip drip1"></div>
		<div class="drip drip2"></div>
		<div class="drip drip3"></div>
		<div class="candle">
			<div class="flame"></div>
		</div>
	</div>
	<div class="text-center">
	</div>

</div>

	<canvas id="meter" width="500" height="50"></canvas>


<script src="js/cake.js"></script>
<script src="js/volume-meter.js"></script>
<script src="js/audioDetectionConfig.js"></script>
<script src="js/audioDetection.js"></script>
<script src="js/audioStream.js"></script>

<script src="js/demoAudioRecorder.js"></script>
<script src="js/demoAudioDetectionListeners.js"></script>
<script src="js/demo.js"></script>


<script>
  // เลือก element cake-holder
  const cakeHolder = document.getElementById('cake-holder');

  // สังเกตการเปลี่ยนแปลง class
  const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
          if (mutation.attributeName === 'class') {
              // ถ้า class มี "done" แสดงว่า cake-off ปรากฏ
              if (cakeHolder.classList.contains('done')) {
                  // รอ 1.5 วินาทีให้ animation จบ แล้วไปหน้าใหม่
                  setTimeout(() => {
                      window.location.href = 'letter.html'; // เปลี่ยนเป็นหน้าที่ต้องการ
                  }, 1500);
              }
          }
      });
  });

  // เริ่มสังเกต attribute class
  observer.observe(cakeHolder, { attributes: true });
</script>

</body>
</html>